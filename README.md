# نظام إدارة ورشة المعادن
## Metal Sheets Management System

<div align="center">

![Version](https://img.shields.io/badge/version-1.0.0-blue.svg)
![React](https://img.shields.io/badge/React-18.2-61dafb.svg)
![Material--UI](https://img.shields.io/badge/Material--UI-v5-007FFF.svg)
![License](https://img.shields.io/badge/license-Proprietary-red.svg)

**نظام متكامل وحديث لإدارة ورش المعادن**

[المميزات](#-المميزات-الرئيسية) • [التثبيت](#-التثبيت) • [الاستخدام](#-الاستخدام) • [التوثيق](#-التوثيق)

</div>

---

## 📋 نظرة عامة / Overview

نظام شامل ومتكامل لإدارة ورشة المعادن يوفر جميع الأدوات اللازمة لإدارة المخزون، المبيعات، العملاء، الموردين، والحسابات بكفاءة عالية.

A comprehensive and modern metal workshop management system providing all necessary tools for managing inventory, sales, customers, suppliers, and accounting efficiently.

### ✨ لماذا هذا النظام؟ / Why This System?

- 🎯 **مصمم خصيصاً لورش المعادن** - يلبي جميع احتياجات القطاع
- 🚀 **سريع وفعّال** - تقنيات حديثة لأداء عالي
- 🔐 **آمن وموثوق** - حماية بيانات متقدمة ونسخ احتياطي تلقائي
- 📱 **سهل الاستخدام** - واجهة بديهية باللغة العربية
- 💯 **متكامل** - جميع العمليات في مكان واحد

---

## 🚀 المميزات الرئيسية / Key Features

### 📦 إدارة المخزون / Inventory Management

- ✅ **نظام FIFO متقدم** - تتبع دقيق للصفائح المعدنية والدفعات
- ✅ **إدارة البواقي الذكية** - استغلال أمثل للمواد المتبقية
- ✅ **حسابات تلقائية** - أوزان، أسعار، وتكاليف دقيقة
- ✅ **عرض منظم** - فصل واضح بين الصفائح الكاملة والبواقي
- ✅ **تتبع شامل** - معلومات تفصيلية لكل صفيحة ودفعة

### 💰 المبيعات / Sales System

- 🛒 **أنواع بيع متعددة**:
  - بيع صفيحة كاملة من المخزون
  - بيع بواقي جاهزة
  - قص من صفيحة مع إنشاء بواقي تلقائياً
  - إضافة خدمات (قص، ثني، تشطيب)
- 💳 **إدارة مدفوعات مرنة** - دفع كامل، جزئي، أو آجل
- 🎨 **تلوين ذكي للأسعار** - تحذير فوري للخسائر
- 📊 **تقارير شاملة** - متابعة دقيقة للمبيعات والأرباح

### 👥 إدارة العلاقات / CRM

- **نظام العملاء**:
  - ✅ سجلات كاملة لكل عميل
  - ✅ تتبع الأرصدة والمدفوعات
  - ✅ كشوف حساب تفصيلية
  - ✅ سجل كامل للمعاملات

- **نظام الموردين**:
  - ✅ إدارة المشتريات والدفعات
  - ✅ حسابات جارية دقيقة
  - ✅ سجل شامل للتوريدات

### 📊 النظام المحاسبي / Accounting

- 💰 **قائمة الدخل الشاملة** - أرباح وخسائر مفصلة
- 📈 **تقارير مالية متقدمة** - تحليل دقيق للأداء المالي
- 💵 **دعم عملات متعددة** - إدارة معاملات بعملات مختلفة
- 🧾 **إدارة المصروفات** - تصنيف وتتبع كامل للمصاريف
- 📋 **كشوف حساب تفصيلية** - لجميع العملاء والموردين

### 🔐 الأمان والموثوقية / Security

- 🔒 **تشفير متقدم** - حماية كلمات المرور (bcrypt)
- 👤 **إدارة مستخدمين** - صلاحيات وأدوار متعددة
- 💾 **نسخ احتياطي تلقائي** - حماية البيانات المستمرة
- ⚠️ **معالجة أخطاء ذكية** - تنبيهات واضحة وحلول فورية
- 🛡️ **حماية XSS** - أمان متقدم ضد الثغرات

### 🎨 واجهة مستخدم حديثة / Modern UI

- ✨ **تصميم موحد وعصري** - واجهة احترافية سهلة الاستخدام
- 📱 **متجاوب بالكامل** - يعمل على جميع الأجهزة والشاشات
- 🌙 **دعم RTL كامل** - مثالي للغة العربية
- ⚡ **سريع وسلس** - أداء عالي مع تحميل ذكي
- ✅ **نوافذ تأكيد** - حماية من الأخطاء غير المقصودة

---

## 🛠️ التقنيات المستخدمة / Technology Stack

| المكون | التقنية | الإصدار |
|--------|---------|---------|
| **Frontend** | React | 18.2.0 |
| **UI Framework** | Material-UI | v5 |
| **Database** | SQL.js (SQLite) | WebAssembly |
| **Build Tool** | Vite | 5.4.20 |
| **Desktop App** | Electron | 28.3.1 |
| **Testing** | Vitest | Latest |
| **Language** | JavaScript | ES6+ |

### مميزات تقنية إضافية:
- ⚡ **Lazy Loading** - تحميل سريع ومحسّن
- 🎯 **Code Splitting** - حزم صغيرة وفعالة
- 🔍 **13 فهرس SQL** - استعلامات فائقة السرعة
- 🔄 **React Suspense** - تجربة مستخدم سلسة
- 📦 **Component-Based** - كود منظم وقابل للصيانة

---

## 📥 التثبيت / Installation

### المتطلبات / Requirements

- **Node.js**: 16.0 أو أحدث / 16.0 or higher
- **npm**: 7.0 أو أحدث / 7.0 or higher
- **المساحة**: 200 MB تقريباً / ~200 MB disk space

### خطوات التثبيت / Installation Steps

```bash
# 1. استنساخ المشروع / Clone the repository
git clone [repository-url]
cd metal-sheets-management

# 2. تثبيت المكتبات / Install dependencies
npm install

# 3. تشغيل التطبيق في وضع التطوير / Run in development mode
npm run dev

# 4. فتح المتصفح / Open browser
# التطبيق سيعمل على: http://localhost:5173
# Application will run at: http://localhost:5173
```

### البناء للإنتاج / Production Build

```bash
# بناء التطبيق / Build application
npm run build

# معاينة النسخة / Preview build
npm run preview

# بناء تطبيق سطح المكتب (Electron) / Build desktop app
npm run electron:build
```

---

## 🎯 الإعداد الأولي / Initial Setup

### 1️⃣ تسجيل الدخول الأول / First Login

عند تشغيل التطبيق لأول مرة:

```
👤 اسم المستخدم / Username: admin
🔑 كلمة المرور / Password: اتركها فارغة / Leave blank
```

⚠️ **مهم جداً**: سيُطلب منك تعيين كلمة مرور قوية فوراً لحماية النظام.

### 2️⃣ إعداد بيانات الشركة / Company Setup

**من تبويب الإعدادات ⚙️ > إعدادات الشركة:**

1. ✍️ اسم الشركة والمعلومات الأساسية
2. 📍 العنوان وبيانات الاتصال
3. 🆔 الرقم الضريبي (إن وجد)
4. 🖼️ شعار الشركة (اختياري)

### 3️⃣ إعداد النظام الأساسي / System Configuration

**أ. العملات 💵:**
- إضافة العملة الأساسية (مثال: ريال سعودي)
- إضافة عملات إضافية إن لزم الأمر
- تحديد أسعار الصرف

**ب. طرق الدفع 💳:**
- نقدي / Cash
- شيك / Check
- تحويل بنكي / Bank Transfer
- إضافة طرق أخرى حسب الحاجة

**ج. أنواع المعادن 🔩:**
- إضافة أنواع المعادن (حديد، ألمنيوم، ستانلس ستيل...)
- تحديد الدرجات (Grade 304, Grade 316...)
- تحديد أنواع التشطيب (Mirror, Matt, Brushed...)
- تعيين الكثافة لكل نوع

**د. الخدمات 🛠️:**
- إضافة الخدمات المتوفرة (قص، ثني، لحام...)
- تحديد الأسعار الافتراضية

### 4️⃣ إضافة المستخدمين 👥 (اختياري)

إذا كان لديك عدة مستخدمين:
- إضافة حسابات للموظفين
- تحديد الأدوار والصلاحيات
- كل مستخدم يحتاج كلمة مرور قوية

---

## 📱 دليل الاستخدام / User Guide

### 📦 إدارة المخزون

#### إضافة صفيحة معدنية جديدة:

1. 📋 **تبويب المخزون** → زر "إضافة صفيحة جديدة"
2. 📝 **أدخل المعلومات الأساسية**:
   - الكود (يُنشأ تلقائياً أو يمكن تخصيصه)
   - نوع المعدن، الدرجة، التشطيب
   - الأبعاد (طول × عرض × سماكة)
3. ⚖️ **إدخال الوزن**:
   - حساب تلقائي من الأبعاد
   - أو إدخال يدوي
4. 💰 **التسعير**:
   - السعر لكل كيلو
   - أو السعر الإجمالي
5. 📦 **بيانات الدفعة**:
   - المورد
   - الكمية المستلمة
   - تاريخ الاستلام
   - الموقع في المخزن

#### إدارة البواقي:

- **إضافة بقية يدوياً**: من تبويب البواقي
- **البواقي التلقائية**: تُنشأ تلقائياً عند القص من صفيحة
- **بيع البواقي**: مثل بيع الصفائح العادية

### 💰 إنشاء فاتورة مبيعات

#### خطوة 1: المعلومات الأساسية
- اختر العميل (أو اترك فاتورة بدون عميل)
- تاريخ البيع
- العملة
- ملاحظات (اختياري)

#### خطوة 2: إضافة الأصناف

**أ. بيع صفيحة كاملة:**
1. اختر الصفيحة من القائمة
2. حدد الكمية المطلوبة
3. راجع السعر (تحذير إذا كان أقل من الحد الأدنى)

**ب. بيع بواقي:**
1. اختر البقية من القائمة
2. حدد الكمية
3. راجع السعر

**ج. قص من صفيحة:**
1. اختر الصفيحة
2. أدخل أبعاد القطعة المطلوبة
3. حدد الكمية
4. النظام يحسب الوزن تلقائياً
5. أدخل السعر
6. **مهم**: حدد البواقي الناتجة من القص

**د. إضافة خدمة:**
1. اختر نوع الخدمة
2. وصف المادة (اختياري)
3. حدد السعر والكمية

#### خطوة 3: الدفع والإنهاء
- راجع الإجمالي
- أضف خصم (إن وجد)
- أدخل المبلغ المدفوع
- اختر طريقة الدفع
- احفظ الفاتورة

### 👥 إدارة العملاء والموردين

#### العملاء:
- **إضافة عميل**: البيانات الأساسية + جهات الاتصال
- **تسديد دفعة**: تسجيل المدفوعات من العملاء
- **كشف حساب**: عرض جميع المعاملات والرصيد

#### الموردين:
- **إضافة مورد**: معلومات كاملة
- **تسديد دفعة**: تسجيل الدفع للموردين
- **كشف حساب**: متابعة المستحقات

### 📊 التقارير والتحليلات

**من تبويب التقارير:**
- 📈 **ملخص المبيعات**: إجماليات وإحصائيات
- 💰 **تحليل الأرباح**: ربح المواد والخدمات
- 📦 **المنتجات الأكثر مبيعاً**: تحليل الطلب
- 👥 **أفضل العملاء**: حسب حجم المشتريات
- 💵 **ملخص المصروفات**: حسب الفئات
- 📊 **قيمة المخزون**: تقييم المخزون الحالي

### 💳 إدارة المدفوعات

**من تبويب المدفوعات:**
- تسجيل دفعات العملاء
- تسجيل دفعات الموردين
- عرض سجل جميع المدفوعات
- فلترة حسب النوع والتاريخ

---

## 🔧 الصيانة والنسخ الاحتياطي / Maintenance

### 💾 النسخ الاحتياطي / Backup

**النسخ التلقائي:**
- يتم تلقائياً عند وصول حجم قاعدة البيانات إلى 4MB
- يُحفظ في مجلد Downloads

**النسخ اليدوي:**
1. الإعدادات ⚙️ → إدارة قاعدة البيانات
2. زر "تصدير قاعدة البيانات"
3. احفظ الملف في مكان آمن

**استعادة النسخة:**
1. الإعدادات ⚙️ → إدارة قاعدة البيانات
2. زر "استيراد قاعدة بيانات"
3. اختر ملف النسخة الاحتياطية

⚠️ **نصيحة**: احتفظ بنسخ احتياطية أسبوعية في مكان آمن خارج الجهاز.

### 🗑️ إعادة تعيين البيانات / Reset Data

**من الإعدادات → إدارة قاعدة البيانات:**

1. **حذف البيانات المعاملاتية فقط**:
   - المبيعات، المشتريات، المدفوعات، المصروفات
   - يحتفظ بـ: العملاء، الموردين، المخزون، الإعدادات

2. **حذف البيانات الأساسية**:
   - العملاء، الموردين، المخزون
   - يحتفظ بـ: المستخدمين والإعدادات

3. **إعادة تعيين كاملة**:
   - حذف جميع البيانات
   - العودة للإعدادات الأولية
   - ⚠️ **لا يمكن التراجع!**

---

## 🗂️ هيكل المشروع / Project Structure

```
metal-sheets-management/
├── src/
│   ├── components/
│   │   ├── tabs/                    # الواجهات الرئيسية
│   │   │   ├── CustomersTab.jsx     # إدارة العملاء
│   │   │   ├── SuppliersTab.jsx     # إدارة الموردين
│   │   │   ├── InventoryTab.jsx     # إدارة المخزون
│   │   │   ├── SalesTab.jsx         # المبيعات
│   │   │   ├── ExpensesTab.jsx      # المصروفات
│   │   │   ├── PaymentsTab.jsx      # المدفوعات
│   │   │   ├── RemnantsTab.jsx      # البواقي
│   │   │   ├── ReportsTab.jsx       # التقارير
│   │   │   └── SettingsTab.jsx      # الإعدادات
│   │   ├── common/                  # المكونات المشتركة
│   │   │   ├── forms/               # نماذج موحدة
│   │   │   │   ├── UnifiedFormField.jsx
│   │   │   │   └── UnifiedFormDialog.jsx
│   │   │   └── dialogs/             # نوافذ موحدة
│   │   │       └── UnifiedConfirmDialog.jsx
│   │   ├── sales/                   # مكونات المبيعات
│   │   ├── ErrorNotification.jsx    # نظام الأخطاء
│   │   ├── Dashboard.jsx            # لوحة التحكم
│   │   └── Login.jsx                # تسجيل الدخول
│   ├── utils/
│   │   ├── database/                # قاعدة البيانات
│   │   │   ├── core.js              # الوظائف الأساسية
│   │   │   ├── schema.js            # البنية
│   │   │   ├── inventory.js         # المخزون
│   │   │   ├── sales.js             # المبيعات
│   │   │   ├── customers.js         # العملاء
│   │   │   ├── suppliers.js         # الموردين
│   │   │   ├── expenses.js          # المصروفات
│   │   │   ├── accounting.js        # المحاسبة
│   │   │   ├── reports.js           # التقارير
│   │   │   └── users.js             # المستخدمين
│   │   ├── validation/              # التحقق من البيانات
│   │   ├── security/                # الأمان
│   │   ├── displayHelpers.js        # مساعدات العرض (XSS Protection)
│   │   └── theme.js                 # الثيم
│   ├── theme/
│   │   └── designSystem.js          # نظام التصميم الموحد
│   ├── tests/                       # الاختبارات (115+ tests)
│   ├── App.jsx                      # التطبيق الرئيسي
│   └── main.jsx                     # نقطة الدخول
├── public/                          # الملفات العامة
├── dist/                            # ملفات البناء
└── electron/                        # تطبيق سطح المكتب
```

---

## ⚡ الأداء والتحسينات / Performance

### تحسينات الأداء المطبقة:

- ✅ **Lazy Loading** - تحميل المكونات عند الحاجة فقط
- ✅ **Code Splitting** - فصل الحزم لتحميل أسرع
- ✅ **Memoization** - تقليل عمليات الحساب المكررة
- ✅ **Database Indexes** - 13 فهرس لاستعلامات فائقة السرعة
- ✅ **Debouncing** - تقليل العمليات في البحث والحفظ
- ✅ **Request Idle Callback** - عمليات خلفية ذكية
- ✅ **Virtual Scrolling** - للقوائم الطويلة

### أرقام الأداء:

| المقياس | القيمة |
|---------|--------|
| **أول حمولة** | < 2 ثانية |
| **استعلام قاعدة بيانات** | < 50ms |
| **حفظ فاتورة** | < 100ms |
| **حجم الحزمة** | ~490 KB (gzipped: ~159 KB) |
| **عدد الفهارس** | 13 |

---

## 🧪 الاختبارات / Testing

### الاختبارات المطبقة:

```bash
# تشغيل جميع الاختبارات / Run all tests
npm test

# اختبارات مع التغطية / Tests with coverage
npm run test:coverage

# اختبارات في وضع المراقبة / Watch mode
npm run test:watch
```

### تفاصيل الاختبارات:

- ✅ **115+ Unit Tests** - تغطية شاملة
- ✅ **Input Validation Tests** - 40+ test
- ✅ **XSS Protection Tests** - 20+ test مع 11 attack vector
- ✅ **FIFO Logic Tests** - 15+ test
- ✅ **Accounting Tests** - 15+ test
- ✅ **Pricing Calculations Tests** - 15+ test
- ✅ **Formatters Tests** - 10+ test

---

## 🐛 معالجة الأخطاء / Error Handling

### نظام معالجة الأخطاء الشامل:

- 🚨 **Error Boundaries** - لكل تبويب رئيسي
- 📢 **إشعارات عامة** - تنبيهات واضحة ومفصلة
- 📋 **زر النسخ** - نسخ تفاصيل الخطأ بضغطة واحدة
- 🔍 **تفاصيل قابلة للتوسع** - معلومات تقنية عند الحاجة
- 🌐 **رسائل بالعربية** - سهلة الفهم
- 📝 **سجل الأخطاء** - تتبع جميع المشاكل

### أنواع معالجة الأخطاء:

1. **أخطاء قاعدة البيانات** - معالجة تلقائية مع rollback
2. **أخطاء التحقق** - رسائل واضحة للمستخدم
3. **أخطاء الشبكة** - إعادة محاولة تلقائية
4. **أخطاء غير متوقعة** - حفظ الحالة واستعادة

---

## 🔐 الأمان / Security Features

### ميزات الأمان المطبقة:

- 🔒 **تشفير bcrypt** - كلمات مرور آمنة (10 rounds)
- 🛡️ **XSS Protection** - حماية من هجمات البرمجة النصية
- 💉 **SQL Injection Prevention** - استخدام Prepared Statements
- ⏱️ **Rate Limiting** - حماية من هجمات القوة الغاشمة
- 👤 **Session Management** - إدارة جلسات آمنة
- 🔐 **Role-Based Access** - صلاحيات حسب الدور
- 💾 **Encrypted Backups** - نسخ احتياطية آمنة

### سياسات الأمان:

- ✅ كلمات مرور قوية إلزامية
- ✅ تغيير كلمة المرور عند أول دخول
- ✅ تسجيل خروج تلقائي بعد فترة عدم نشاط
- ✅ تدقيق جميع المدخلات
- ✅ حماية ضد CSRF

---

## 🌐 النشر / Deployment

### نشر على Vercel (موصى به):

1. ربط المستودع بحساب Vercel
2. النشر التلقائي عند كل push
3. الإعدادات موجودة في `vercel.json`

```bash
# التحقق من البناء قبل النشر
npm run build
npm run preview
```

### نشر محلي:

```bash
# بناء للإنتاج
npm run build

# الملفات ستكون في مجلد dist/
# يمكن نشرها على أي خادم ويب
```

### متطلبات الخادم:

- ✅ دعم ملفات Single Page Application
- ✅ HTTPS (موصى به)
- ✅ Gzip compression
- ✅ مساحة تخزين: 50MB+

---

## 📚 الموارد والدعم / Resources

### التوثيق:

- 📖 **دليل المستخدم**: هذا الملف
- 🎓 **أمثلة الاستخدام**: داخل التطبيق
- 💡 **نصائح وإرشادات**: في كل صفحة

### الدعم الفني:

- 📧 البريد الإلكتروني: [your-email]
- 🐛 الإبلاغ عن الأخطاء: [GitHub Issues]
- 💬 المناقشات: [GitHub Discussions]

### الموارد الإضافية:

- [React Documentation](https://react.dev)
- [Material-UI Documentation](https://mui.com)
- [SQL.js Documentation](https://github.com/sql-js/sql.js)

---

## 🔄 التحديثات المستقبلية / Roadmap

### قيد التطوير:

- [ ] تطبيق الهاتف المحمول (React Native)
- [ ] نظام الإشعارات Push
- [ ] ربط مع أنظمة خارجية (ERP)
- [ ] تقارير متقدمة مع رسوم بيانية
- [ ] نظام الباركود
- [ ] طباعة الباركود للصفائح
- [ ] تصدير التقارير PDF/Excel

### تحسينات مخططة:

- [ ] Dark Mode
- [ ] تحسينات AI للتنبؤات
- [ ] Dashboard تفاعلي متقدم
- [ ] نظام الإشعارات الذكية
- [ ] تحليلات متقدمة

---

## 📄 الرخصة / License

**© 2025 جميع الحقوق محفوظة / All Rights Reserved**

هذا نظام خاص ومملوك. لا يجوز استخدامه أو نسخه أو توزيعه إلا بإذن كتابي صريح من المالك.

This is proprietary software. Use, copying, or distribution requires explicit written permission.

---

## 🤝 المساهمة / Contributing

هذا مشروع خاص. إذا كنت ترغب في المساهمة، يرجى التواصل مع المالك.

This is a private project. For contribution inquiries, please contact the owner.

---

## 🙏 شكر وتقدير / Acknowledgments

تم بناء هذا النظام باستخدام تقنيات مفتوحة المصدر رائعة:

- **React** - مكتبة واجهات المستخدم
- **Material-UI** - مكتبة المكونات
- **SQL.js** - قاعدة البيانات
- **Vite** - أداة البناء
- **Vitest** - إطار الاختبار

---

<div align="center">

**بُني بكل ❤️ باستخدام أحدث التقنيات**

**Built with ❤️ using Modern Technologies**

---

**نظام إدارة ورشة المعادن v1.0.0**

**Metal Sheets Management System v1.0.0**

</div>
